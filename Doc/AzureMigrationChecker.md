| 手動 | 確認内容                                                 |                                                                                                                             | 設定方法                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | チェック項目                                                                                                                                                                                       |                                                               | Checker             |
|----|------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|---------------------|
| 〇  | OS イメージを一般化する前に Windows システム ファイル チェッカー ユーティリティを実行する |                                                                                                                             | sfc.exe /scannow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                              |                                                               |                     |
|    | Azure 用の Windows 構成を設定する                             | 1. ルーティング テーブル内の静的な固定ルートをすべて削除します                                                                                           | ・ルーティング テーブルを表示するには、route.exe print を実行します。<br/>・[Persistence Routes](固定ルート) セクションを確認します。 固定ルートがある場合は、route.exe delete コマンドを使って削除します。<br/><br/>Get-Item -Path 'Registry::HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\PersistentRoutes' | Select -ExpandProperty Property | %{route delete $_.Split(',')[0]}                                                                                                                                                                                                                                                                                                                                            | Get-NetRoute | Where-Object {($_.Protocol -eq 'NetMgmt') -and ($_.DestinationPrefix -ne '0.0.0.0/0') -and ($_.AddressFamily -eq 'IPv4')}                                                     | 存在しない                                                         | Check01             |
|    |                                                      | 2. WinHTTP プロキシを削除します。                                                                                                      | netsh.exe winhttp reset proxy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | netsh winhttp show proxy                                                                                                                                                                     | Direct access (no proxy server)  が含まれる                        | Check02             |
|    |                                                      | 3. ディスク SAN ポリシーを Onlineall に設定します。                                                                                         | diskpart.exe<br/><br/>DISKPART> san policy=onlineall<br/>DISKPART> exit                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | echo san | diskpart                                                                                                                                                                          | SAN Policy  : Online All が含まれる                                | Check03             |
|    |                                                      | 4. Windows の協定世界時 (UTC) の時刻を設定します。 また、Windows Time サービス (w32time) の起動の種類を Automatic に設定します。                                 | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\TimeZoneInformation' -Name RealTimeIsUniversal -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\TimeZoneInformation' -Name RealTimeIsUniversal | Select -ExpandProperty RealTimeIsUniversal                                   | １                                                             | Check04             |
|    |                                                      |                                                                                                                             | Set-Service -Name w32time -StartupType Automatic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Get-Service -Name w32time | Select -ExpandProperty StartType                                                                                                                                 | Automatic                                                     | Check05             |
|    |                                                      | 5. 電源プロファイルを高パフォーマンスに設定します。                                                                                                 | powercfg.exe /setactive SCHEME_MIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | powercfg /getactivescheme                                                                                                                                                                    | GUID: 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c                    | Check06             |
|    |                                                      | 6. 環境変数の TEMP と TMP を既定値に設定                                                                                                 | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment' -Name TEMP -Value '%SystemRoot%\TEMP' -Type ExpandString -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment' -Name TEMP | Select -ExpandProperty TEMP                                                         | C:\Windows\TEMP                                               | Check07             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment' -Name TMP -Value '%SystemRoot%\TEMP' -Type ExpandString -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment' -Name TMP | Select -ExpandProperty TMP                                                           | C:\Windows\TEMP                                               | Check08             |
|    |                                                      | 7. レガシ オペレーティング システム (Windows Server 2012 R2 または Windows 8.1 以下) が使用されている VM では、最新の Hyper-V 統合コンポーネント サービスがインストールされていることを確認 | https://support.microsoft.com/topic/hyper-v-integration-components-update-for-windows-virtual-machines-8a74ffad-576e-d5a0-5a2f-d6fb2594f990                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Virtual Machine\Auto' -Name IntegrationServicesVersion | Select -ExpandProperty IntegrationServicesVersion                                  | 存在する                                                          | Check09             |
|    | Windows サービスの確認                                      | 次の各 Windows サービスが Windows の既定値に設定されていることを確認                                                                                 | Get-Service -Name BFE, Dhcp, Dnscache, IKEEXT, iphlpsvc, nsi, mpssvc, RemoteRegistry | Where-Object StartType -ne Automatic | Set-Service -StartupType Automatic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Get-Service -Name BFE, Dhcp, Dnscache, IKEEXT, iphlpsvc, nsi, mpssvc, RemoteRegistry | Where-Object {$_.StartType -ne 'Automatic'}  | Select Name,StartType                                  | 存在しない                                                         | Check10             |
|    |                                                      |                                                                                                                             | Get-Service -Name Netlogon, Netman, TermService | Where-Object StartType -ne Manual | Set-Service -StartupType Manual                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Get-Service -Name Netlogon, Netman, TermService | Where-Object {$_.StartType -ne 'Manual'}  | Select Name,StartType                                                                          | 存在しない                                                         | Check11             |
|    | リモート デスクトップのレジストリ設定を更新する                             | 1. リモート デスクトップ プロトコル (RDP) が有効になっていることを確認                                                                                   | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name fDenyTSConnections -Value 0 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name fDenyTSConnections | Select -ExpandProperty fDenyTSConnections                                         | 0                                                             | Check12             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name fDenyTSConnections -Value 0 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name fDenyTSConnections | Select -ExpandProperty fDenyTSConnections                                 | 0                                                             | Check13             |
|    |                                                      | 2. RDP ポートを既定のポート 3389 になっていることを確認                                                                                          | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name PortNumber -Value 3389 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name PortNumber | Select -ExpandProperty PortNumber                                     | 3389                                                          | Check14             |
|    |                                                      | 3. リスナーがすべてのネットワーク インターフェイスでリッスンしていることを確認                                                                                   | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name LanAdapter -Value 0 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name LanAdapter | Select -ExpandProperty LanAdapter                                     | 0                                                             | Check15             |
|    |                                                      | 4. RDP 接続のネットワーク レベル認証 (NLA) モードを確認                                                                                         | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name UserAuthentication -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name UserAuthentication | Select -ExpandProperty UserAuthentication                     | 1                                                             | Check16             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name SecurityLayer -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name SecurityLayer | Select -ExpandProperty SecurityLayer                               | 1                                                             | Check17             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name fAllowSecProtocolNegotiation -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name fAllowSecProtocolNegotiation | Select -ExpandProperty fAllowSecProtocolNegotiation | 1                                                             | Check18             |
|    |                                                      | 5. キープアライブ値を設定                                                                                                              | Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name KeepAliveEnable -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name KeepAliveEnable | Select -ExpandProperty KeepAliveEnable                                       | 1                                                             | Check19             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name KeepAliveInterval -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name KeepAliveInterval | Select -ExpandProperty KeepAliveInterval                                   | 1                                                             | Check20             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name KeepAliveTimeout -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name KeepAliveTimeout | Select -ExpandProperty KeepAliveTimeout                         | 1                                                             | Check21             |
|    |                                                      | 6. 再接続オプションを設定                                                                                                              | Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name fDisableAutoReconnect -Value 0 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -Name fDisableAutoReconnect | Select -ExpandProperty fDisableAutoReconnect                           | 0                                                             | Check22             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name fInheritReconnectSame -Value 1 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name fInheritReconnectSame | Select -ExpandProperty fInheritReconnectSame               | 1                                                             | Check23             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name fReconnectSame -Value 0 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name fReconnectSame | Select -ExpandProperty fReconnectSame                             | 0                                                             | Check24             |
|    |                                                      | 7. コンカレント接続数を制限                                                                                                         | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name MaxInstanceCount -Value 4294967295 -Type DWord -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -Name MaxInstanceCount | Select -ExpandProperty MaxInstanceCount                         | 4294967295                                                    | Check25             |
|    |                                                      | 8. RDP リスナーに関連付けられている自己署名証明書をすべて削除                                                                                          | if ((Get-Item -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp').Property -contains 'SSLCertificateSHA1Hash')<br/>{<br/>    Remove-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name 'SSLCertificateSHA1Hash' -Force<br/>}                                                                                                                                                                                                                                                                                                                                                    | (Get-Item -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp').Property -contains 'SSLCertificateSHA1Hash'                                                    | False                                                         | Check26             |
|    | Windows ファイアウォール規則の構成                                | 1. 3 つのプロファイル (ドメイン、標準、パブリック) で Windows ファイアウォールを有効に設定                                                                      | Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled True                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Get-NetFirewallProfile -Profile Domain, Public, Private | Where-Object {$_.Enabled -ne 'True'}  | Select Name,Enabled                                                                        | 存在しない                                                         | Check27             |
|    |                                                      | 2. 3 つのファイアウォール プロファイル (ドメイン、プライベート、パブリック) を通じて WinRM を許可し、PowerShell リモート サービスを有効に設定                                       | Enable-PSRemoting -Force                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Get-Service -Name WinRM | Select -ExpandProperty StartType                                                                                                                                   | Automatic                                                     | Check28             |
|    |                                                      |                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | winrm e winrm/config/listener                                                                                                                                                                | Address = *,Transport = HTTP,Port = 5985  が含まれる               | Check29             |
|    |                                                      |                                                                                                                             | Set-NetFirewallRule -Name WINRM-HTTP-In-TCP, WINRM-HTTP-In-TCP-PUBLIC -Enabled True                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Get-NetFirewallRule -Name WINRM-HTTP-In-TCP, WINRM-HTTP-In-TCP-PUBLIC | Where-Object {$_.Enabled -ne 'True'}  | Select Name,Enabled                                                          | 存在しない                                                         | Check30             |
|    |                                                      | 3. RDP トラフィックを許可するために以下のファイアウォール規則を有効に設定                                                                                    | Set-NetFirewallRule -DisplayGroup 'Remote Desktop' -Enabled True                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Get-NetFirewallRule -DisplayGroup 'Remote Desktop'  | Where-Object {$_.Enabled -ne 'True'}  | Select Name,Enabled                                                                          | 存在しない                                                         | Check31             |
|    |                                                      | 4. VM が仮想ネットワーク内部の ping 要求に応答できるように、"ファイルとプリンターの共有" 規則を有効に設定                                                                | Set-NetFirewallRule -Name FPS-ICMP4-ERQ-In -Enabled True                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Get-NetFirewallRule -Name FPS-ICMP4-ERQ-In  | Where-Object {$_.Enabled -ne 'True'}  | Select Name,Enabled                                                                                    | 存在しない                                                         | Check32             |
|    |                                                      | 5. Azure プラットフォーム ネットワークのルールを作成                                                                                             | New-NetFirewallRule -DisplayName AzurePlatform -Direction Inbound -RemoteAddress 168.63.129.16 -Profile Any -Action Allow -EdgeTraversalPolicy Allow<br/>New-NetFirewallRule -DisplayName AzurePlatform -Direction Outbound -RemoteAddress 168.63.129.16 -Profile Any -Action Allow                                                                                                                                                                                                                                                                                                                                                                                | Get-NetFirewallRule -DisplayName AzurePlatform                                                                                                                                               | 存在する                                                          | Check33             |
| 〇  | VM の確認                                               | 1. ディスクが正常で一貫性があることを確認                                                                                                      | chkdsk.exe /f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | 2. ブート構成データ (BCD) を設定                                                                                                       | cmd<br/><br/>bcdedit.exe /set "{bootmgr}" integrityservices enable<br/>bcdedit.exe /set "{default}" device partition=C:<br/>bcdedit.exe /set "{default}" integrityservices enable<br/>bcdedit.exe /set "{default}" recoveryenabled Off<br/>bcdedit.exe /set "{default}" osdevice partition=C:<br/>bcdedit.exe /set "{default}" bootstatuspolicy IgnoreAllFailures<br/><br/>#Enable Serial Console Feature<br/>bcdedit.exe /set "{bootmgr}" displaybootmenu yes<br/>bcdedit.exe /set "{bootmgr}" timeout 5<br/>bcdedit.exe /set "{bootmgr}" bootems yes<br/>bcdedit.exe /ems "{current}" ON<br/>bcdedit.exe /emssettings EMSPORT:1 EMSBAUDRATE:115200<br/><br/>exit |                                                                                                                                                                                              |                                                               |                     |
|    |                                                      | 3. Dump ログ コレクションを有効に設定                                                                                                     | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name CrashDumpEnabled -Type DWord -Force -Value 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name CrashDumpEnabled | Select -ExpandProperty CrashDumpEnabled                                                | 2                                                             | Check34             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name DumpFile -Type ExpandString -Force -Value '%SystemRoot%\MEMORY.DMP'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name DumpFile | Select -ExpandProperty DumpFile                                                                | C:\Windows\MEMORY.DMP                                         | Check35             |
|    |                                                      |                                                                                                                             | Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name NMICrashDump -Type DWord -Force -Value 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -Name NMICrashDump | Select -ExpandProperty NMICrashDump                                                        | 1                                                             | Check36             |
|    |                                                      |                                                                                                                             | $key = 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps'<br/>if ((Test-Path -Path $key) -eq $false) {(New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting' -Name LocalDumps)}                                                                                                                                                                                                                                                                                                                                                                                                                                             | Test-Path -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps'                                                                                                        | True                                                          | Check37             |
|    |                                                      |                                                                                                                             | New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name DumpFolder -Type ExpandString -Force -Value 'C:\CrashDumps'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name DumpFolder | Select -ExpandProperty DumpFolder                                            | C:\CrashDumps                                                 | Check38             |
|    |                                                      |                                                                                                                             | New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name CrashCount -Type DWord -Force -Value 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name CrashCount | Select -ExpandProperty CrashCount                                            | 10                                                            | Check39             |
|    |                                                      |                                                                                                                             | New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name DumpType -Type DWord -Force -Value 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -Name DumpType | Select -ExpandProperty DumpType                                                | 2                                                             | Check40             |
|    |                                                      |                                                                                                                             | Set-Service -Name WerSvc -StartupType Manual                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Get-Service -Name WerSvc | Select -ExpandProperty StartType                                                                                                                                  | Manual                                                        | Check41             |
|    |                                                      | 4. Windows Management Instrumentation (WMI) リポジトリに一貫性があることを確認                                                               | winmgmt.exe /verifyrepository                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | winmgmt.exe /verifyrepository                                                                                                                                                                | WMI repository is consistent                                  | Check42             |
|    |                                                      | 5. TermService 以外のアプリケーションがポート 3389 を使用していないことを確認                                                                           | netstat.exe -anob | findstr 3389                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Get-CimInstance CIM_Service | Where-Object {$_.ProcessID -eq (Get-NetTCPConnection -LocalPort 3389)[0].OwningProcess} | Select -ExpandProperty Name                                          | TermService                                                   | Check43             |
|    |                                                      | 6. ドメイン コントローラーである Windows VHD をアップロードするための追加の手順                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | 7. あらかじめ登録された Administrator アカウントとパスワードを把握していることを確認                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | 8. RDP アクセスをブロックしていないことを確認                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | コンピューターの構成\Windows の設定\セキュリティの設定\ローカル ポリシー\ユーザー権利の割り当て\ネットワーク経由のアクセスを拒否                                                                                                                      | Administrator アカウントが拒否されていないことを確認                             |                     |
| 〇  |                                                      |                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | コンピューターの構成\Windows の設定\セキュリティの設定\ローカル ポリシー\ユーザー権利の割り当て\リモート デスクトップ サービスを使ったログオンを拒否                                                                                                           | Administrator アカウントが拒否されていないことを確認                             |                     |
| 〇  |                                                      | 9. 必要なアクセス アカウントがいずれも削除されていないことを確認                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | コンピューターの構成\Windows の設定\セキュリティの設定\ローカル ポリシー\ユーザー権利の割り当て\ネットワーク経由でのアクセス                                                                                                                        | Administrators,Backup Operators,Everyone,Users が削除されていないことを確認 |                     |
| 〇  |                                                      | 10. VM を再起動して、Windows が引き続き正常であり、RDP 接続を介してアクセス可能であることを確認                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | 11. 余分な Transport Driver Interface (TDI) フィルターはすべて削除、TCP パケットや追加のファイアウォールを分析するソフトウェアは削除します。                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | 12. 物理コンポーネントまたはその他の仮想化テクノロジに関連する、その他のサードパーティ ソフトウェアまたはドライバーをアンインストール                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               |                     |
|    | Windows 更新プログラムのインストール                               | Sheet2の更新プログラムがインストールされていることを確認                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                              |                                                               | Check44<br/>Check45 |
| 〇  | 仮想ディスクを容量固定の VHD に変換する                               | PowerShell を使用してディスクを変換する                                                                                                   | Convert-VHD -Path C:\test\MyVM.vhdx -DestinationPath C:\test\MyNewVM.vhd -VHDType Fixed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                              |                                                               |                     |
| 〇  |                                                      | PowerShell を使用してディスクのサイズを変更する                                                                                               | Resize-VHD -Path C:\test\MyNewVM.vhd -SizeBytes 105906176                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |